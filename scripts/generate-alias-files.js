// Generates 'alias'.js|ts files until they can be generated and added to ext-react module.
// These are used to import plugins, layouts, proxies, etc instead of 
const path = require('path');
const fs = require('fs');
const inflection = require('inflection');

let aliases = ["widget.actionsheet","widget.audio","widget.button","widget.component","widget.container","widget.dialog","widget.window","widget.editor","widget.image","widget.img","widget.indicator","widget.label","widget.loadmask","widget.mask","widget.media","widget.messagebox","widget.panel","widget.progress","widget.progressbarwidget","widget.segmentedbutton","widget.sheet","widget.spacer","widget.title","widget.titlebar","widget.paneltool","widget.tool","widget.toolbar","widget.video","widget.widget","controller.controller","viewmodel.default","widget.carousel","store.array","store.buffered","store.chained","store.direct","store.jsonp","store.json","store.node","store.store","store.tree","store.xml","data.field.bool","data.field.boolean","data.field.date","data.field.auto","data.field.int","data.field.integer","data.field.float","data.field.number","data.field.string","data.identifier.default","data.identifier.negative","data.identifier.sequential","data.identifier.uuid","data.operation.create","data.operation.destroy","data.operation.read","data.operation.update","proxy.ajax","proxy.direct","proxy.jsonp","proxy.scripttag","proxy.localstorage","proxy.memory","proxy.proxy","proxy.rest","proxy.server","proxy.sessionstorage","reader.array","reader.json","reader.base","reader.xml","request.ajax","request.form","namer.default","schema.default","data.summary.average","data.summary.base","data.summary.count","data.summary.max","data.summary.min","data.summary.sum","data.validator.bound","data.validator.cidrv4","data.validator.cidrv6","data.validator.currency","data.validator.currency-us","data.validator.date","data.validator.datetime","data.validator.email","data.validator.exclusion","data.validator.format","data.validator.ipaddress","data.validator.inclusion","data.validator.length","data.validator.list","data.validator.notnull","data.validator.number","data.validator.phone","data.validator.presence","data.validator.range","data.validator.time","data.validator.url","data.validator.base","store.virtual","writer.json","writer.base","writer.xml","widget.boundlist","navmodel.boundlist","widget.componentdataview","widget.dataitem","widget.dataview","widget.emptytext","widget.indexbar","widget.itemheader","widget.list","widget.listitem","navmodel.dataview","widget.nestedlist","widget.simplelistitem","widget.listswiperaccordion","widget.listswiperitem","plugin.listswiper","widget.listswiperstepper","plugin.dataviewtip","plugin.listpaging","plugin.sortablelist","widget.pullrefreshbar","plugin.pullrefresh","widget.pullrefreshspinner","selmodel.dataview","selection.records","selection.rows","direct.event","direct.exception","direct.jsonprovider","direct.pollingprovider","direct.provider","direct.rpc","direct.remotingprovider","direct.transaction","drag.constraint.base","drag.proxy.none","drag.proxy.original","drag.proxy.placeholder","widget.checkbox","widget.checkboxfield","widget.combobox","widget.comboboxfield","widget.containerfield","widget.fieldcontainer","widget.datefield","widget.datepickerfield","widget.datepickernativefield","widget.displayfield","widget.emailfield","widget.field","widget.filefield","widget.filebutton","widget.hiddenfield","widget.inputfield","widget.numberfield","widget.fieldpanel","widget.passwordfield","widget.pickerfield","widget.radio","widget.radiofield","widget.searchfield","widget.selectfield","widget.singlesliderfield","widget.sliderfield","widget.spinnerfield","widget.textfield","widget.textareafield","widget.togglefield","widget.urlfield","trigger.base","trigger.clear","widget.cleartrigger","trigger.component","trigger.date","widget.datetrigger","trigger.expand","widget.expandtrigger","trigger.file","trigger.menu","widget.menutrigger","trigger.reveal","widget.revealtrigger","trigger.search","widget.searchtrigger","trigger.spindown","widget.spindowntrigger","trigger.spinup","widget.spinuptrigger","trigger.trigger","widget.trigger","widget.fieldset","widget.formpanel","animation.cube","animation.fade","animation.fadeIn","animation.fadeOut","animation.flip","animation.pop","animation.popIn","animation.popOut","animation.slide","animation.slideIn","animation.slideOut","easing.ease-in","easing.ease-out","easing.linear","widget.celleditor","widget.grid","widget.headercontainer","navmodel.grid","widget.pagingtoolbar","widget.gridrow","widget.rowbody","widget.rowheader","widget.gridsummaryrow","widget.tree","widget.gridcellbase","widget.booleancell","widget.gridcell","widget.checkcell","widget.datecell","widget.expandercell","widget.numbercell","widget.rownumberercell","widget.textcell","widget.treecell","widget.widgetcell","widget.booleancolumn","widget.checkcolumn","widget.column","widget.gridcolumn","widget.templatecolumn","widget.datecolumn","widget.numbercolumn","widget.rownumberer","widget.selectioncolumn","widget.textcolumn","widget.treecolumn","widget.gridcolumnsmenu","widget.gridgroupbythismenuitem","widget.gridshowingroupsmenuitem","widget.gridsortascmenuitem","widget.gridsortdescmenuitem","plugin.cellediting","plugin.gridcellediting","plugin.clipboard","plugin.columnresizing","plugin.gridcolumnresizing","plugin.grideditable","plugin.gridpagingtoolbar","plugin.pagingtoolbar","plugin.rowexpander","plugin.gridmultiselection","plugin.multiselection","plugin.rowoperations","plugin.gridsummary","plugin.gridsummaryrow","plugin.summaryrow","plugin.gridviewoptions","selection.cells","selection.columns","selmodel.grid","plugin.selectionreplicator","layout.auto","layout.default","layout.box","layout.card","layout.carousel","layout.center","layout.fit","layout.float","layout.form","layout.hbox","layout.vbox","layout.card.fx.abstract","layout.card.fx.cover","layout.card.fx.cube","layout.card.fx.fade","layout.card.fx.flip","layout.card.fx.pop","layout.card.fx.reveal","layout.card.fx.scroll","layout.card.fx.scrollcover","layout.card.fx.scrollreveal","layout.card.fx.slide","layout.overflow.scroller","widget.treelist","widget.treelistitem","widget.menucheckitem","widget.menuitem","widget.menu","widget.menuradioitem","widget.menuseparator","widget.navigationview","widget.datepanel","widget.datetitle","widget.dateview","widget.panelheader","widget.paneltitle","widget.yearpicker","widget.datepicker","widget.picker","widget.pickerslot","widget.tabletpicker","plugin.mouseenter","plugin.responsive","plugin.tabguard","scroller.scroller","widget.slider","widget.thumb","widget.toggleslider","widget.sparklinebar","widget.sparkline","widget.sparklinebox","widget.sparklinebullet","widget.sparklinediscrete","widget.sparklineline","widget.sparklinepie","widget.sparklinetristate","widget.tabbar","widget.tabpanel","widget.tab","widget.tooltip","translatable.component","translatable.cssposition","translatable.csstransform","translatable.dom","translatable.scrollparent","translatable.scrollposition","widget.viewport","store.rowexpanderstore","widget.c-preview-global-base","widget.c-preview-global-base-big","widget.c-highlighter","widget.c-preview-progress","widget.c-preview-fieldset","widget.c-preview-link","controller.list","viewmodel.list","controller.main","widget.c-preview-anchored-panel","controller.tree-list","viewmodel.tree-list","viewmodel.tree"];
aliases = aliases.filter(a => !a.match(/^(widget|controller|)\./));

const aliasDefinitions = aliases.reduce((res, a) => {
    const aSplit = a.split('.');
    const aliasType = aSplit[0];
    const aliasName = aSplit[1];
    res[aliasType] = res[aliasType] || [];
    res[aliasType].push(`export const ${aliasName} = '${aliasName}';`);
    return res;
}, {});

const packagesDir = path.resolve(__dirname, '..', 'packages');
fs.readdirSync(packagesDir).forEach(dir => {
    const extReactNMDir = path.join(packagesDir, dir, 'node_modules', '@extjs', 'ext-react');
    
    try {
        if(!fs.statSync(extReactNMDir).isDirectory()) return;
    } catch(e) { return; }

    Object.keys(aliasDefinitions).forEach(aliasType => {
        const aliasPlural = inflection.pluralize(aliasType);
        const fileContents = aliasDefinitions[aliasType].join('\n');
        const filePath = path.join(extReactNMDir, aliasPlural);
        console.log('Writing file: ', filePath);
        fs.writeFileSync(`${filePath}.js`, fileContents);
        fs.writeFileSync(`${filePath}.ts`, fileContents);
    });
});